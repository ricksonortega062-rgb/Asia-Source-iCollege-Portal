    <!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Asia Source iCollege Portal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Outfit:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <!-- FIX: Manage Subjects modal scroll fix -->
  <style>
    /* â”€â”€ MANAGE SUBJECTS MODAL: allow full scroll â”€â”€ */
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card {
      max-width: 740px !important;
      max-height: 90vh !important;
      overflow: hidden !important;
      display: flex !important;
      flex-direction: column !important;
      padding: 0 !important;
    }
    /* Modal title area â€” fixed at top */
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card > .modal-close,
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card > .modal-title,
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card > .modal-sub {
      flex-shrink: 0 !important;
      position: relative !important;
      padding-left: 28px !important;
      padding-right: 28px !important;
    }
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card > .modal-title {
      padding-top: 24px !important;
      margin-bottom: 4px !important;
    }
    #tchSubjectMgrModal .modal-card.tch-subj-mgr-card > .modal-sub {
      margin-bottom: 10px !important;
    }
    /* Content area â€” scrollable */
    #tchSubjectMgrContent {
      flex: 1 !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      padding: 0 !important;
      min-height: 0 !important;
    }
    /* tsm3-wrap fills the content area */
    .tsm3-wrap {
      display: flex !important;
      flex-direction: column !important;
      min-height: 0 !important;
    }
    /* tsm3 catalog is scrollable */
    .tsm3-catalog {
      flex: 1 !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      min-height: 150px !important;
      max-height: calc(90vh - 380px) !important;
      padding: 8px 20px 20px !important;
    }

    /* â”€â”€ STUDENT ACCOUNT: Profile photo area fix â”€â”€ */
    #stuPcPhotoWrap.hidden { display: none !important; }

    /* â”€â”€ ADD SUBJECT MODAL scroll fix for student â”€â”€ */
    #addSubjectModal .modal-card.add-subj-modal-card {
      max-height: 90vh !important;
      overflow: hidden !important;
      display: flex !important;
      flex-direction: column !important;
    }
    #addSubjectContent {
      flex: 1 !important;
      overflow-y: auto !important;
      min-height: 0 !important;
    }
    .asj-catalog {
      max-height: 340px !important;
      overflow-y: auto !important;
    }

    /* â”€â”€ Subject Modal scroll fix â”€â”€ */
    #subjectModal .modal-card {
      max-height: 90vh !important;
      overflow-y: auto !important;
    }
  </style>
</head>
<body>

<!-- â•â• 3D ANIMATED BACKGROUND â•â• -->
<div class="portal-bg" id="portalBg">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>
  <div class="particles" id="particles"></div>
</div>

<!-- â•â•â•â•â•â• LOGIN PAGE â•â•â•â•â•â• -->
<div id="loginPage" class="lp-wrapper">
  <div class="lp-left">
    <div class="lp-left-inner">
      <div class="lp-logo-wrap">
        <div class="logo-orbit-3"></div>
        <div class="logo-orbit-2"></div>
        <div class="logo-orbit"></div>
        <div class="logo-hex-bg"></div>
        <img class="lp-logo-3d" src="logo.png" alt="AS" onerror="this.style.background='linear-gradient(135deg,#c0000a,#7a0006)';this.alt='AS'">
      </div>
      <h1 class="lp-title">ASIA SOURCE<em>iCOLLEGE</em></h1>
      <div class="lp-badge"><span class="lp-dot"></span> Accredited Learning Institution</div>
      <div class="lp-divider"></div>
      <div class="lp-motto-wrap">
        <div class="lp-motto-deco lp-motto-deco-left">"</div>
        <p class="lp-motto">Your Success<br><span class="lp-motto-accent">is Our Goal</span></p>
        <div class="lp-motto-deco lp-motto-deco-right">"</div>
        <div class="lp-motto-underline"></div>
        <p class="lp-motto-sub">â€” Asia Source iCollege</p>
      </div>
      <div class="lp-divider" style="margin-top:10px;margin-bottom:22px;"></div>
      <div class="lp-stats">
        <div class="lp-location-card">
          <div class="lp-location-item">
            <div class="lp-location-pin">ğŸ“</div>
            <div class="lp-location-name">PASIG</div>
            <div class="lp-location-label">Branch Campus</div>
          </div>
          <div class="lp-location-divider"></div>
          <div class="lp-location-item">
            <div class="lp-location-pin">ğŸ“</div>
            <div class="lp-location-name">TAGUIG</div>
            <div class="lp-location-label">Main Branch</div>
          </div>
        </div>
      </div>
      <div class="lp-bottom-deco">
        <div class="lp-deco-line"></div>
        <div class="lp-deco-diamonds">
          <span class="lp-deco-diamond"></span>
          <span class="lp-deco-diamond lp-deco-diamond--lg"></span>
          <span class="lp-deco-diamond"></span>
        </div>
        <div class="lp-deco-line"></div>
      </div>
    </div>
  </div>

  <div class="lp-right">
    <canvas id="loginBgCanvas" class="login-bg-canvas"></canvas>
    <div class="lp-card">
      <div class="lp-card-head">
        <img class="lp-card-logo" src="logo.png" alt="" onerror="this.style.background='linear-gradient(135deg,#c0000a,#7a0006)'">
        <div>
          <div class="lp-card-title">Asia Source <span>iCollege</span></div>
          <div class="lp-card-sub">Welcome! Please sign in to continue.</div>
        </div>
      </div>
      <div class="lp-stripe"></div>
      <div class="auth-tabs">
        <button class="auth-tab active" id="tabLogin" onclick="switchAuth('login')">ğŸ”‘ Log In</button>
        <button class="auth-tab" id="tabSignup" onclick="switchAuth('signup')">âœ¨ Sign Up</button>
      </div>

      <!-- LOGIN FORM -->
      <div id="authLogin">
        <div class="role-toggle">
          <button class="role-btn active" id="btnStudent" onclick="setRole('student')">ğŸ“ Student</button>
          <button class="role-btn" id="btnTeacher" onclick="setRole('teacher')">ğŸ‘©â€ğŸ« Teacher</button>
        </div>
        <div class="alert hidden" id="alertBox"></div>
        <form onsubmit="handleLogin(event)">
          <div class="fg">
            <label>School Email</label>
            <div class="email-wrap">
              <input type="text" id="userId" class="email-input" placeholder="yourname" required oninput="this.value=this.value.replace(/[@\s]/g,'').toLowerCase()">
              <span class="email-sfx">@asiasourceicollege.edu.ph</span>
            </div>
          </div>
          <div class="fg">
            <label>Password <span class="hint-lbl">â€” Your birthday (YYYY-MM-DD)</span></label>
            <div class="pw-wrap">
              <input type="password" id="password" placeholder="e.g. 2008-03-15" required>
              <button type="button" class="pw-eye" onclick="togglePass('password')">ğŸ‘</button>
            </div>
          </div>
          <div class="fg-extras">
            <label class="check-lbl"><input type="checkbox"> Remember me</label>
            <a href="#" class="link-gold">Forgot password?</a>
          </div>
          <button type="submit" class="btn-red" id="loginBtn">Sign In as Student</button>
        </form>
        <div class="demo-box">
          <div class="demo-title">ğŸ“‹ Demo Accounts</div>
          <div class="demo-cols">
            <div class="demo-col">
              <div class="demo-col-label">ğŸ“ Student</div>
              <div class="demo-row"><span>Email</span><span>juan.delacruz</span></div>
              <div class="demo-row"><span>Password</span><span>2008-03-15</span></div>
            </div>
            <div class="demo-col-sep"></div>
            <div class="demo-col">
              <div class="demo-col-label">ğŸ‘©â€ğŸ« Teacher</div>
              <div class="demo-row"><span>Email</span><span>ana.santos</span></div>
              <div class="demo-row"><span>Password</span><span>1985-06-12</span></div>
            </div>
          </div>
          <div class="demo-note">âš  Password format is YYYY-MM-DD (your birthday)</div>
        </div>
      </div>

      <!-- SIGN UP FORM -->
      <div id="authSignup" class="hidden">
        <div class="role-toggle">
          <button class="role-btn active" id="suBtnStu" onclick="setSuRole('student')">ğŸ“ Student</button>
          <button class="role-btn" id="suBtnTch" onclick="setSuRole('teacher')">ğŸ‘©â€ğŸ« Teacher</button>
        </div>
        <div class="alert hidden" id="suAlert"></div>
        <div class="alert success hidden" id="suSuccess"></div>
        <form onsubmit="handleSignUp(event)">
          <div class="fg">
            <label>Full Name</label>
            <input type="text" id="suName" class="plain-input" placeholder="e.g. Maria Santos" required>
          </div>
          <div class="fg">
            <label>School Email</label>
            <div class="email-wrap">
              <input type="text" id="suEmail" class="email-input" placeholder="yourname" required oninput="this.value=this.value.replace(/[@\s]/g,'').toLowerCase()">
              <span class="email-sfx">@asiasourceicollege.edu.ph</span>
            </div>
          </div>
          <div class="fg" id="suBdayFg">
            <label>Birthday <span class="hint-lbl">â€” This becomes your password (YYYY-MM-DD)</span></label>
            <input type="date" id="suBirthday" class="plain-input">
          </div>
          <div class="fg" id="suStrandFg">
            <label>Grade, Strand &amp; Section</label>
            <select id="suStrand" class="plain-input">
              <option value="">â€” Select your strand â€”</option>
              <optgroup label="GRADE 11">
                <option value="G11-HUMSS-A">G11 | HUMSS | Section A</option>
                <option value="G11-HUMSS-B">G11 | HUMSS | Section B</option>
                <option value="G11-STEM-A">G11 | STEM | Section A</option>
                <option value="G11-STEM-B">G11 | STEM | Section B</option>
                <option value="G11-HEHO-A">G11 | H.E-H.O | Section A</option>
                <option value="G11-HEHO-B">G11 | H.E-H.O | Section B</option>
                <option value="G11-ICT-A">G11 | ICT-CP</option>
                <option value="G11-ABM-A">G11 | ABM</option>
              </optgroup>
              <optgroup label="GRADE 12">
                <option value="G12-HUMSS-A">G12 | HUMSS | Section A</option>
                <option value="G12-HUMSS-B">G12 | HUMSS | Section B</option>
                <option value="G12-STEM-A">G12 | STEM | Section A</option>
                <option value="G12-STEM-B">G12 | STEM | Section B</option>
                <option value="G12-HEHO-A">G12 | H.E-H.O | Section A</option>
                <option value="G12-HEHO-B">G12 | H.E-H.O | Section B</option>
                <option value="G12-ICT-A">G12 | ICT-CP</option>
                <option value="G12-ABM-A">G12 | ABM</option>
              </optgroup>
            </select>
          </div>
          <div class="tc-wrap">
            <label class="tc-check-lbl">
              <input type="checkbox" id="suTcCheck" onchange="onTcCheck()">
              <span class="tc-checkmark"></span>
              <span class="tc-text">I have read and agree to the
                <button type="button" class="tc-link" onclick="openTcModal()">Terms &amp; Conditions</button>
              </span>
            </label>
          </div>
          <button type="submit" class="btn-red" id="suSubmitBtn" disabled style="opacity:0.45;cursor:not-allowed;">Create Account</button>
        </form>
        <p class="auth-switch">Already have an account?
          <a href="#" class="link-gold" onclick="switchAuth('login');return false;">Log In here</a></p>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• TERMS & CONDITIONS MODAL â•â•â•â•â•â• -->
<div class="tc-modal-overlay hidden" id="tcModal">
  <div class="tc-modal-card tc-modal-fullscreen">
    <div class="tc-modal-head">
      <div class="tc-modal-icon">ğŸ“‹</div>
      <div>
        <h3 class="tc-modal-title">Terms &amp; Conditions</h3>
        <p class="tc-modal-sub">Asia Source iCollege Student Portal</p>
      </div>
      <button class="modal-close" onclick="closeTcModal()" style="position:relative;top:0;right:0;flex-shrink:0;">âœ•</button>
    </div>
    <div class="tc-body" id="tcBody">
      <div class="tc-section"><h4>1. Acceptance of Terms</h4><p>By creating an account on the Asia Source iCollege Student Portal, you agree to be bound by these Terms and Conditions, our Privacy Policy, and all applicable school regulations. If you do not agree with any of these terms, you may not register or use this portal.</p></div>
      <div class="tc-section"><h4>2. Account Eligibility &amp; Registration</h4><p>Access to this portal is exclusively for currently enrolled students and registered faculty of Asia Source iCollege. You must provide accurate, complete, and current information during registration. Use of false identity or misrepresentation of student/faculty status is strictly prohibited and may result in permanent account suspension.</p></div>
      <div class="tc-section"><h4>3. Account Security &amp; Password</h4><p>Your password is your birthday in YYYY-MM-DD format. You are solely responsible for maintaining the confidentiality of your credentials. You must not share your login credentials with any other person. Asia Source iCollege will not be held liable for any unauthorized access resulting from your failure to secure your account. Notify school administration immediately if you suspect unauthorized use.</p></div>
      <div class="tc-section"><h4>4. Privacy &amp; Data Collection</h4><p>Asia Source iCollege collects personal information including your name, birthday, strand/section, and academic records solely for educational and administrative purposes. Your data will never be sold, shared, or disclosed to third parties without your explicit consent, except as required by law or school policy. Academic records stored in this portal are confidential and protected.</p></div>
      <div class="tc-section"><h4>5. Academic Integrity</h4><p>Grade records and academic data visible in this portal are official school records. Any attempt to manipulate, falsify, or tamper with academic data, including grades and attendance records, is a serious violation of academic integrity and may result in disciplinary action including expulsion and legal proceedings under the Education Act of the Philippines.</p></div>
      <div class="tc-section"><h4>6. Acceptable Use Policy</h4><p>This portal is provided solely for academic and administrative purposes. You agree not to use this system for any unlawful purpose, to harass or harm other users, to attempt unauthorized access to other accounts, or to interfere with system operations. Violations may result in immediate account termination and referral to school authorities.</p></div>
      <div class="tc-section"><h4>7. Intellectual Property</h4><p>All content, design, and functionality of this portal â€” including academic materials, grade systems, and branding â€” are the intellectual property of Asia Source iCollege. You may not reproduce, distribute, or create derivative works without written permission from school administration.</p></div>
      <div class="tc-section"><h4>8. Portal Availability</h4><p>Asia Source iCollege makes no warranty that the portal will be available at all times. Scheduled maintenance and unforeseen outages may occur. The school reserves the right to modify, suspend, or terminate the portal or your access at any time without prior notice, consistent with school policy.</p></div>
      <div class="tc-section"><h4>9. Changes to Terms</h4><p>Asia Source iCollege reserves the right to update these Terms and Conditions at any time. Continued use of the portal after changes constitutes acceptance of the updated terms. Students will be notified of material changes through official school communication channels.</p></div>
      <div class="tc-section"><h4>10. Governing Law</h4><p>These Terms and Conditions are governed by the laws of the Republic of the Philippines, and the rules and regulations of Asia Source iCollege. Any disputes arising from portal use shall be subject to the jurisdiction of the appropriate school disciplinary bodies and, if necessary, Philippine courts.</p></div>
    </div>
    <div class="tc-footer">
      <div class="tc-scroll-hint" id="tcScrollHint">ğŸ“œ Please scroll to read all terms before accepting</div>
      <button class="tc-accept-btn" id="tcAcceptBtn" onclick="acceptTc()" disabled>
        <span>âœ… I Accept All Terms &amp; Conditions</span>
      </button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• STUDENT DASHBOARD â•â•â•â•â•â• -->
<div id="studentDash" class="page hidden">
  <nav class="dash-nav">
    <div class="nav-accent"></div>
    <div class="dash-brand" onclick="goHome()" title="ğŸ  Home">
      <img src="logo.png" alt="" onerror="this.style.display='none'"> Asia Source iCollege
    </div>
    <div class="nav-right">
      <button class="dm-nav-btn" onclick="toggleDark()"><span id="dmNavIcon">ğŸŒ™</span></button>
      <div class="user-pill"><div class="uavatar">S</div><span id="stuName">Student</span></div>
      <button class="btn-logout" onclick="logout()">Log Out</button>
    </div>
  </nav>
  <div class="dash-body">
    <div class="stu-layout">
      <aside class="stu-sidebar">
        <div class="profile-card clickable-profile" onclick="openProfileModal()" title="Click to view/edit profile">
          <div class="pc-avatar-wrap" id="stuAvatarWrap">
            <div class="pc-avatar-ring"></div>
            <!-- FIX: Student photo support in sidebar -->
            <div class="pc-avatar" id="stuAvatarEmoji">ğŸ“</div>
            <div id="stuPcPhotoWrap" class="hidden" style="width:72px;height:72px;border-radius:50%;overflow:hidden;position:relative;z-index:2;">
              <img id="stuPcPhoto" src="" alt="Profile" style="width:100%;height:100%;object-fit:cover;">
            </div>
          </div>
          <div class="pc-name" id="stuProfileName">Student</div>
          <div class="pc-badge" id="stuProfileStrand">-</div>
          <div class="pc-email" id="stuProfileEmail">-</div>
          <div class="pc-row"><span>Birthday:</span><span id="stuProfileBday">-</span></div>
          <div class="pc-row"><span>Email:</span><span id="stuProfileLRN">-</span></div>
          <div class="profile-edit-hint">âœï¸ Click to edit profile</div>
        </div>
      </aside>
      <div class="stu-main">
        <div class="stu-subjects-header">
          <div class="sec-title">ğŸ“š My Subjects</div>
          <button class="btn-add-subject" onclick="openAddSubjectModal()">â• Add Subject</button>
        </div>
        <div id="subjectList" class="subject-list"></div>
        <div class="sec-title">ğŸ“‹ Grade Card</div>
        <div class="grade-card">
          <div id="gwaBar" class="gwa-bar" style="display:none;align-items:center;gap:12px;padding:10px 14px;background:rgba(255,255,255,0.04);border-radius:10px;margin-bottom:10px;"></div>
          <table class="grade-table">
            <thead><tr><th>Subject</th><th>1st Sem</th><th>2nd Sem</th><th>Final</th><th>Remarks</th></tr></thead>
            <tbody id="gradeCardBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• TEACHER DASHBOARD â•â•â•â•â•â• -->
<div id="teacherDash" class="page hidden">
  <nav class="dash-nav">
    <div class="nav-accent"></div>
    <div class="dash-brand" onclick="goHome()" title="ğŸ  Home">
      <img src="logo.png" alt="" onerror="this.style.display='none'"> Asia Source iCollege
    </div>
    <div class="nav-right">
      <button class="dm-nav-btn" onclick="toggleDark()"><span id="dmNavIcon2">ğŸŒ™</span></button>
      <button class="btn-settings-gear" onclick="openScoreSettingsModal()" title="Configure Score Settings">âš™ï¸</button>
      <div class="notif-wrap" style="position:relative;">
        <button class="notif-bell-btn" onclick="openTeacherNotifPanel()" title="Notifications">
          ğŸ””
          <span class="notif-badge hidden" id="tchNotifBadge">0</span>
        </button>
        <div class="teacher-notif-panel hidden" id="teacherNotifPanel"></div>
      </div>
      <button class="btn-add-student" onclick="openAddStudentModal()">â• Add Student</button>
      <div class="user-pill"><div class="uavatar t">T</div><span id="tchName">Teacher</span></div>
      <button class="btn-logout" onclick="logout()">Log Out</button>
    </div>
  </nav>
  <div class="dash-body">
    <div class="tch-layout">
      <aside class="tch-sidebar">
        <div class="profile-card clickable-profile" onclick="openProfileModal()" title="Click to view/edit profile">
          <div class="pc-avatar-wrap">
            <div class="pc-avatar-ring"></div>
            <div class="pc-avatar">ğŸ‘©â€ğŸ«</div>
          </div>
          <div class="pc-name" id="tchProfileName">Teacher</div>
          <div class="pc-badge">Faculty</div>
          <div class="pc-email" id="tchProfileEmail">-</div>
          <div class="profile-edit-hint">âœï¸ Click to edit profile</div>
        </div>
        <div class="sidebar-section-lbl">Strand Folders</div>
        <div class="strand-list" id="strandList">
          <div class="gl-folder-group">
            <div class="gl-folder-hdr gl-g11">ğŸ”µ Grade 11</div>
            <div class="strand-item active" data-strand="HUMSS" data-grade="G11" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">HUMSS</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-11">G11</span></div>
            <div class="strand-item" data-strand="STEM" data-grade="G11" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">STEM</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-11">G11</span></div>
            <div class="strand-item" data-strand="HE-HO" data-grade="G11" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">H.E-H.O</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-11">G11</span></div>
            <div class="strand-item" data-strand="ICT" data-grade="G11" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">ICT - CP</div><div class="si-sub">Student List</div></div><span class="si-gl-badge si-gl-11">G11</span></div>
            <div class="strand-item" data-strand="ABM" data-grade="G11" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">ABM</div><div class="si-sub">Student List</div></div><span class="si-gl-badge si-gl-11">G11</span></div>
          </div>
          <div class="gl-folder-group">
            <div class="gl-folder-hdr gl-g12">ğŸŸ¢ Grade 12</div>
            <div class="strand-item" data-strand="HUMSS" data-grade="G12" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">HUMSS</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-12">G12</span></div>
            <div class="strand-item" data-strand="STEM" data-grade="G12" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">STEM</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-12">G12</span></div>
            <div class="strand-item" data-strand="HE-HO" data-grade="G12" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">H.E-H.O</div><div class="si-sub">Section A &amp; B</div></div><span class="si-gl-badge si-gl-12">G12</span></div>
            <div class="strand-item" data-strand="ICT" data-grade="G12" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">ICT - CP</div><div class="si-sub">Student List</div></div><span class="si-gl-badge si-gl-12">G12</span></div>
            <div class="strand-item" data-strand="ABM" data-grade="G12" onclick="openFolder(this)"><span class="si-icon">ğŸ“</span><div><div class="si-name">ABM</div><div class="si-sub">Student List</div></div><span class="si-gl-badge si-gl-12">G12</span></div>
          </div>
        </div>
      </aside>
      <div class="tch-main">
        <div class="tch-header">
          <div class="tch-header-left">
            <div class="tch-folder-title" id="folderTitle">HUMSS â€” Student List</div>
            <div class="tch-folder-sub">Select quarter or subject, enter grades, then save.</div>
          </div>
          <div class="tch-header-right">
            <div class="view-tabs">
              <button class="vtab active" id="vtabGradebook" onclick="setView('gradebook',this)">ğŸ“Š Gradebook</button>
              <button class="vtab" id="vtabClassRec" onclick="setView('classrecord',this)">ğŸ“‹ Class Record</button>
              <button class="vtab" id="vtabAttend" onclick="setView('attendance',this)">ğŸ“… Attendance</button>
            </div>
            <div class="sec-tabs" id="secTabsWrap">
              <button class="stab active" onclick="switchSection('A',this)">Section A</button>
              <button class="stab" onclick="switchSection('B',this)">Section B</button>
            </div>
          </div>
        </div>
        <div id="viewGradebook" class="tch-view">
          <div id="gbToolbar" class="view-toolbar"></div>
          <div class="cr-scroll-wrap">
            <table class="gb-table">
              <thead>
                <tr>
                  <th class="gb-num">#</th>
                  <th class="gb-name">Student Name</th>
                  <th colspan="3" class="gb-group-th" style="background:rgba(14,165,233,0.35);">ğŸ“ Quizzes</th>
                  <th colspan="3" class="gb-group-th" style="background:rgba(16,185,129,0.35);">ğŸ¯ Activities</th>
                  <th colspan="2" class="gb-group-th" style="background:rgba(245,158,11,0.35);">ğŸ“ Projects</th>
                  <th class="gb-group-th" style="background:rgba(232,0,15,0.35);">ğŸ“„ Exam</th>
                  <th>Computed</th>
                  <th>Remarks</th>
                  <th id="gbSubjTh" class="gb-subj-th">Subject Grade</th>
                </tr>
                <tr class="gb-sub-header">
                  <th></th><th></th>
                  <th class="gb-sub-th" style="color:#7dd3fc;">Q1 /20</th>
                  <th class="gb-sub-th" style="color:#7dd3fc;">Q2 /20</th>
                  <th class="gb-sub-th" style="color:#7dd3fc;">Q3 /20</th>
                  <th class="gb-sub-th" style="color:#6ee7b7;">A1 /20</th>
                  <th class="gb-sub-th" style="color:#6ee7b7;">A2 /20</th>
                  <th class="gb-sub-th" style="color:#6ee7b7;">A3 /20</th>
                  <th class="gb-sub-th" style="color:#fcd34d;">P1 /50</th>
                  <th class="gb-sub-th" style="color:#fcd34d;">P2 /50</th>
                  <th class="gb-sub-th" style="color:#fca5a5;">Exam /100</th>
                  <th></th><th></th><th></th>
                </tr>
              </thead>
              <tbody id="gbBody"></tbody>
            </table>
          </div>
          <div class="legend-bar">
            <span>90â€“100: Outstanding</span><span>85â€“89: Very Satisfactory</span>
            <span>80â€“84: Satisfactory</span><span>75â€“79: Fairly Satisfactory</span>
            <span>Below 75: Did Not Meet Expectations</span>
          </div>
        </div>
        <div id="viewClassRecord" class="tch-view hidden">
          <div id="crToolbar" class="view-toolbar"></div>
          <div class="cr-scroll-wrap">
            <table class="cr-table"><thead id="crHead"></thead><tbody id="crBody"></tbody></table>
          </div>
          <div class="legend-bar">
            <span>90â€“100: Outstanding</span><span>85â€“89: Very Satisfactory</span>
            <span>80â€“84: Satisfactory</span><span>75â€“79: Fairly Satisfactory</span>
            <span>Below 75: Did Not Meet Expectations</span>
          </div>
        </div>
        <div id="viewAttendance" class="tch-view hidden">
          <div class="att-legend">
            <span class="att-key att-p">P = Present</span>
            <span class="att-key att-a">A = Absent</span>
            <span class="att-key att-l">L = Late</span>
            <span class="att-hint">Type P, A, or L in each cell</span>
          </div>
          <div class="cr-scroll-wrap">
            <table class="cr-table"><thead><tr id="attMonthRow"></tr><tr id="attDayRow"></tr></thead><tbody id="attBody"></tbody></table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• SUBJECT MODAL â•â•â•â•â•â• -->
<div class="modal-overlay hidden" id="subjectModal" onclick="if(event.target===this)closeSubjectModal()">
  <div class="modal-card">
    <button class="modal-close" onclick="closeSubjectModal()">âœ•</button>
    <h3 class="modal-title" id="subjectModalTitle">Subject</h3>
    <p class="modal-sub" id="subjectModalSub"></p>
    <div id="subjectModalContent"></div>
  </div>
</div>

<!-- â•â•â•â•â•â• ADD SUBJECT MODAL â€” STUDENT â•â•â•â•â•â• -->
<div class="modal-overlay hidden" id="addSubjectModal" onclick="if(event.target===this)closeAddSubjectModal()">
  <div class="modal-card add-subj-modal-card">
    <button class="modal-close" onclick="closeAddSubjectModal()">âœ•</button>
    <h3 class="modal-title">ğŸ“š Enroll in Subject</h3>
    <p class="modal-sub">Select a subject and choose your teacher</p>
    <div id="addSubjectContent"></div>
  </div>
</div>

<!-- â•â•â•â•â•â• ADD STUDENT MODAL â€” TEACHER â•â•â•â•â•â• -->
<div class="modal-overlay hidden" id="addStudentModal" onclick="if(event.target===this)closeAddStudentModal()">
  <div class="modal-card add-stu-modal-card">
    <button class="modal-close" onclick="closeAddStudentModal()">âœ•</button>
    <div id="addStudentContent"></div>
  </div>
</div>

<!-- â•â•â•â•â•â• SCORE SETTINGS MODAL â€” TEACHER â•â•â•â•â•â• -->
<div class="modal-overlay hidden" id="scoreSettingsModal" onclick="if(event.target===this)closeScoreSettingsModal()">
  <div class="modal-card settings-modal-card">
    <button class="modal-close" onclick="closeScoreSettingsModal()">âœ•</button>
    <div class="sm-settings-head">
      <div class="sm-settings-title">âš™ï¸ Score Settings</div>
      <div class="sm-settings-sub">Configure maximum scores for each component â€” computation auto-adjusts</div>
    </div>
    <div class="sm-settings-body" id="scoreSettingsBody"></div>
    <div class="sm-settings-footer">
      <button class="btn-settings-save" onclick="saveScoreSettingsFromModal()">ğŸ’¾ Save Settings</button>
      <button class="btn-settings-reset" onclick="resetScoreSettings()">ğŸ”„ Reset to Defaults</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â• PROFILE MODAL â•â•â•â•â•â• -->
<div class="modal-overlay hidden" id="profileModal" onclick="if(event.target===this)closeProfileModal()">
  <div class="modal-card profile-modal-card">
    <button class="modal-close" onclick="closeProfileModal()">âœ•</button>
    <div class="pm-header">
      <div class="pm-avatar-wrap">
        <div class="pm-avatar-ring-2"></div>
        <div class="pm-avatar-ring"></div>
        <div class="pm-avatar" id="pmAvatar">ğŸ“</div>
        <!-- FIX: Photo overlay in profile modal -->
        <div id="pmPhotoOverlay" class="hidden" style="position:absolute;inset:0;border-radius:50%;overflow:hidden;z-index:3;">
          <img id="pmPhotoImg" src="" alt="Profile Photo" style="width:100%;height:100%;object-fit:cover;">
        </div>
      </div>
      <div class="pm-head-info">
        <h3 class="pm-name" id="pmName">Student Name</h3>
        <div class="pm-role-badge" id="pmRoleBadge">Student</div>
        <div class="pm-email-display" id="pmEmailDisplay">â€”</div>
      </div>
    </div>
    <div class="pm-tabs">
      <button class="pm-tab active" id="pmTabInfo" onclick="switchPmTab('info',this)">ğŸ‘¤ Profile Info</button>
      <button class="pm-tab" id="pmTabPass" onclick="switchPmTab('password',this)">ğŸ” Reset Password</button>
      <button class="pm-tab" id="pmTabPhoto" onclick="switchPmTab('photo',this)" style="display:none;">ğŸ“· Photo</button>
    </div>
    <div id="pmPanelInfo" class="pm-panel">
      <div class="alert hidden" id="pmInfoAlert"></div>
      <div class="alert success hidden" id="pmInfoSuccess"></div>
      <div class="pm-info-grid">
        <div class="pm-info-item"><div class="pm-info-icon">ğŸªª</div><div class="pm-info-body"><div class="pm-info-lbl">Student ID</div><div class="pm-info-val" id="pmInfoStudentId">â€”</div></div></div>
        <div class="pm-info-item"><div class="pm-info-icon">âš§</div><div class="pm-info-body"><div class="pm-info-lbl">Gender</div><div class="pm-info-val" id="pmInfoGender">â€”</div></div></div>
        <div class="pm-info-item"><div class="pm-info-icon">ğŸ‘¤</div><div class="pm-info-body"><div class="pm-info-lbl">Full Name</div><div class="pm-info-val" id="pmInfoName">â€”</div></div></div>
        <div class="pm-info-item"><div class="pm-info-icon">ğŸ‚</div><div class="pm-info-body"><div class="pm-info-lbl">Date of Birth</div><div class="pm-info-val" id="pmInfoBday">â€”</div></div></div>
        <div class="pm-info-item pm-info-wide"><div class="pm-info-icon">ğŸ“§</div><div class="pm-info-body"><div class="pm-info-lbl">Email Address</div><div class="pm-info-val" id="pmInfoEmail">â€”</div></div></div>
        <div class="pm-info-item"><div class="pm-info-icon">ğŸ“±</div><div class="pm-info-body"><div class="pm-info-lbl">Mobile Number</div><div class="pm-info-val" id="pmInfoMobile">â€”</div></div></div>
        <div class="pm-info-item"><div class="pm-info-icon">ğŸ¯</div><div class="pm-info-body"><div class="pm-info-lbl">Age</div><div class="pm-info-val" id="pmInfoAge">â€”</div></div></div>
        <div class="pm-info-item pm-info-wide" id="pmStrandItem"><div class="pm-info-icon">ğŸ“š</div><div class="pm-info-body"><div class="pm-info-lbl">Strand / Section</div><div class="pm-info-val" id="pmInfoStrand">â€”</div></div></div>
        <div class="pm-info-item pm-info-wide" id="pmAddressItem"><div class="pm-info-icon">ğŸ </div><div class="pm-info-body"><div class="pm-info-lbl">Home Address</div><div class="pm-info-val" id="pmInfoAddress">â€”</div></div></div>
        <div class="pm-info-item pm-info-wide"><div class="pm-info-icon">ğŸ™ï¸</div><div class="pm-info-body"><div class="pm-info-lbl">City</div><div class="pm-info-val" id="pmInfoCity">â€”</div></div></div>
      </div>
      <div class="pm-edit-section">
        <div class="pm-edit-title">âœï¸ Edit Profile</div>
        <div class="pm-edit-row2">
          <div class="fg"><label>Full Name</label><input type="text" id="pmEditName" class="plain-input" placeholder="Your full name"></div>
          <div class="fg"><label>Gender</label><select id="pmEditGender" class="plain-input"><option value="">â€” Select â€”</option><option value="Male">Male</option><option value="Female">Female</option><option value="Prefer not to say">Prefer not to say</option></select></div>
        </div>
        <div class="pm-edit-row2">
          <div class="fg"><label>Mobile Number</label><input type="tel" id="pmEditMobile" class="plain-input" placeholder="e.g. 09XX-XXX-XXXX"></div>
          <div class="fg"><label>City</label><input type="text" id="pmEditCity" class="plain-input" placeholder="e.g. Quezon City"></div>
        </div>
        <div class="fg"><label>Home Address</label><input type="text" id="pmEditAddress" class="plain-input" placeholder="e.g. 123 Rizal St., Barangay..."></div>
        <div class="fg" id="pmEditStrandFg" style="display:none">
          <label>Strand &amp; Section</label>
          <select id="pmEditStrand" class="plain-input">
            <option value="">Select strand</option>
            <optgroup label="GRADE 11">
              <option value="G11-HUMSS-A">G11 | HUMSS | Section A</option><option value="G11-HUMSS-B">G11 | HUMSS | Section B</option>
              <option value="G11-STEM-A">G11 | STEM | Section A</option><option value="G11-STEM-B">G11 | STEM | Section B</option>
              <option value="G11-HEHO-A">G11 | H.E-H.O | Section A</option><option value="G11-HEHO-B">G11 | H.E-H.O | Section B</option>
              <option value="G11-ICT-A">G11 | ICT-CP</option><option value="G11-ABM-A">G11 | ABM</option>
            </optgroup>
            <optgroup label="GRADE 12">
              <option value="G12-HUMSS-A">G12 | HUMSS | Section A</option><option value="G12-HUMSS-B">G12 | HUMSS | Section B</option>
              <option value="G12-STEM-A">G12 | STEM | Section A</option><option value="G12-STEM-B">G12 | STEM | Section B</option>
              <option value="G12-HEHO-A">G12 | H.E-H.O | Section A</option><option value="G12-HEHO-B">G12 | H.E-H.O | Section B</option>
              <option value="G12-ICT-A">G12 | ICT-CP</option><option value="G12-ABM-A">G12 | ABM</option>
            </optgroup>
          </select>
        </div>
        <button class="btn-red" onclick="saveProfileInfo()">ğŸ’¾ Save Profile</button>
      </div>
    </div>
    <div id="pmPanelPass" class="pm-panel hidden">
      <div class="alert hidden" id="pmPassAlert"></div>
      <div class="alert success hidden" id="pmPassSuccess"></div>
      <div class="pm-pass-intro">
        <div class="pm-pass-icon">ğŸ”</div>
        <p>Enter your current password, then choose your new password. You can use any password you like.</p>
      </div>
      <div class="fg"><label>Current Password</label><div class="pw-wrap"><input type="password" id="pmCurrPass" class="plain-input" placeholder="Your current password" style="padding-right:44px"><button type="button" class="pw-eye" onclick="togglePass('pmCurrPass')">ğŸ‘</button></div></div>
      <div class="fg"><label>New Password</label><div class="pw-wrap"><input type="password" id="pmNewPass" class="plain-input" placeholder="Choose any new password" style="padding-right:44px"><button type="button" class="pw-eye" onclick="togglePass('pmNewPass')">ğŸ‘</button></div></div>
      <div class="fg"><label>Confirm New Password</label><div class="pw-wrap"><input type="password" id="pmConfPass" class="plain-input" placeholder="Repeat your new password" style="padding-right:44px"><button type="button" class="pw-eye" onclick="togglePass('pmConfPass')">ğŸ‘</button></div></div>
      <button class="btn-red" onclick="saveNewPassword()">ğŸ” Reset Password</button>
    </div>
    <!-- FIX: Photo panel for student profile modal -->
    <div id="pmPanelPhoto" class="pm-panel hidden">
      <div style="text-align:center;padding:16px 0 8px;">
        <div style="font-size:13px;color:var(--muted);margin-bottom:14px;">Upload a profile photo (JPG/PNG, max ~2MB)</div>
        <div style="position:relative;width:110px;height:110px;margin:0 auto 16px;border-radius:50%;overflow:hidden;border:2px solid rgba(255,255,255,0.15);background:rgba(255,255,255,0.04);">
          <div id="pmPhotoPlaceholder" style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:44px;">ğŸ“</div>
          <img id="pmPhotoPreviewImg" src="" alt="Preview" class="hidden" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;">
        </div>
        <label style="display:inline-block;padding:8px 18px;border-radius:8px;background:rgba(59,130,246,0.15);border:1px solid rgba(59,130,246,0.4);color:#93c5fd;cursor:pointer;font-size:12px;font-weight:600;margin-bottom:10px;">
          ğŸ“ Choose Photo
          <input type="file" accept="image/*" style="display:none;" onchange="handlePhotoUpload(event)">
        </label>
        <div id="pmPhotoSuccess" class="hidden" style="color:#5dde92;font-size:12px;margin-bottom:8px;">âœ… Photo saved!</div>
        <div style="display:flex;gap:8px;justify-content:center;">
          <button class="btn-red" onclick="saveProfilePhoto()" style="font-size:12px;padding:8px 16px;">ğŸ’¾ Save Photo</button>
          <button onclick="removeProfilePhoto()" style="font-size:12px;padding:8px 16px;background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.35);color:#f87171;border-radius:8px;cursor:pointer;">ğŸ—‘ï¸ Remove</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• TEACHER SUBJECT MANAGER MODAL â•â• -->
<!-- FIX: Changed structure so content area is properly scrollable -->
<div class="modal-overlay hidden" id="tchSubjectMgrModal" onclick="if(event.target===this)closeTchSubjectMgr()">
  <div class="modal-card tch-subj-mgr-card" style="padding:0;overflow:hidden;display:flex;flex-direction:column;max-height:90vh;max-width:740px;">
    <button class="modal-close" onclick="closeTchSubjectMgr()">âœ•</button>
    <div id="tchSubjectMgrContent" style="flex:1;overflow-y:auto;overflow-x:hidden;min-height:0;"></div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>
